<!DOCTYPE html>
<head>
    <title>Simulator voznje</title>
    <style>
    .pedalo{
      border:1px solid black;
      width:4vw;
      height:20vh;
    }
    .volan
    {
      height:11vw;
      width:11vw;
    }
    </style>
</head>
<body>
  <center>
  <!--script src="Skripti/three.js"></script>
  <script src="Skripti/Igrca.js"></script-->
</center>
  <br />

  <canvas id="sklopka" class="pedalo"></canvas>
  <canvas id="bremza" class="pedalo"></canvas>
  <canvas id="plin" class="pedalo"></canvas>
  <img src="Slike/volan.png" class="volan" id="volan1"></img>

  <script type="module">

  const socket = new WebSocket('ws://localhost:8080');
  let povezan=false;
  let plin=0;
  let sklopka=0;
  let bremza=0;
  let volan=0;
  let rotacija=0;

  let svolan = new Image();
  svolan.src= "Slike/volan.png";

  socket.onmessage=({data}) =>
  {
    let tmp = JSON.parse(data);
    plin=(tmp["plin"]/100);
    sklopka=(tmp["sklopka"]/100);
    bremza=(tmp["bremza"]/100);
    volan=(tmp["volan"]);
  }
  function premakni()
  {

  }
  function izrisi(pedalo,vrednost)
  {
    if(vrednost>=15)
      vrednost=0;
    let cp=document.getElementById(pedalo);
    let conp =cp.getContext('2d');
    conp.clearRect(0, 0, cp.width, cp.height);
    conp.fillStyle = "#00CC00";
    conp.fillRect(0,cp.height-vrednost*cp.height,cp.width,vrednost*cp.height);
  }

  function izrisivolan(volan)
  {
    if(volan-rotacija!=0)
      document.getElementById("volan1").style.transform = "rotate("+ rotacija.toString()+"deg)";
    rotacija+=(volan-rotacija)*0.04;

  }
  setInterval(()=>{
        socket.send("podatki");

      izrisi("plin",plin);
      izrisi("bremza",bremza);
      izrisi("sklopka",sklopka)
      izrisivolan(volan);
    },10
  );

  );
  </script>
</body>
</html>
